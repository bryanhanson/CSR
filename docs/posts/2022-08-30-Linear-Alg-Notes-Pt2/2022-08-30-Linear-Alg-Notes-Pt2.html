<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bryan Hanson">
<meta name="dcterms.date" content="2022-08-14">
<meta name="description" content="Motivations - What connects all this stuff?">

<title>Chemometrics and Spectroscopy Using R - Notes on Linear Algebra Part 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: 1;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Chemometrics and Spectroscopy Using R - Notes on Linear Algebra Part 2">
<meta name="twitter:description" content="Motivations - What connects all this stuff?">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chemometrics and Spectroscopy Using R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html">Projects</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.r-bloggers.com/">R-Bloggers</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:hanson@depauw.edu"><i class="bi bi-envelope-fill" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/profbryanhanson"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bryanhanson"><i class="bi bi-git" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notes on Linear Algebra Part 2</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Linear Algebra</div>
  </div>
  </div>

<div>
  <div class="description">
    Motivations - What connects all this stuff?
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bryan Hanson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 14, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="tldr" class="level4">
<h4 class="anchored" data-anchor-id="tldr">TL;DR</h4>
<ul>
<li>Linear systems of equations are at the heart, not surprisingly, of linear algebra.</li>
<li>A key application is linear regression.</li>
<li>Solving the needed equations requires inverting a matrix.</li>
<li>something something</li>
<li>Other methods are built on top of the basic operations.</li>
<li>Notations and symbols are killer.</li>
</ul>
<hr>
<p>For Part 1 of this series, see <a href="https://chemospec.org/posts/2022-08-14-Linear-Alg-Notes/2022-08-14-Linear-Alg-Notes.html">here</a>.</p>
<p>If you open a linear algebra text, it’s quickly apparent at how complex the field is. There are so many special types of matrices, so many different decompositions of matrices. Why are all these needed? What’s really important? What are the threads that tie the different concepts together? As someone who is trying to improve their understanding of the field, especially with regard to its applications in chemometrics, it can be a tough slog.</p>
<p>In this post I’m going to try to make an argument about how to look at the field so that one can tie the topics together and progress in one’s understanding. I’m looking for the core concepts and their connections. Though I cover some math details here, they are pretty light: the conceptual connections are far more important. We can deal with the math details later, probably much more easily if we know why are doing the harder work.</p>
<p>In this post, matrices, including row and column vectors, will be shown in bold e.g.&nbsp;<span class="math inline">\(\mathbf{A}\)</span> while scalars and variables will be shown in italics, e.g.&nbsp;<span class="math inline">\(n\)</span>.</p>
</section>
<section id="systems-of-equations" class="level2">
<h2 class="anchored" data-anchor-id="systems-of-equations">Systems of Equations</h2>
<p>If you’ve had algebra, you have certainly run into “system of equations” such as the following:</p>
<p><span id="eq-1"><span class="math display">\[
\begin{multline}
x + 2y -3z = 3 \\
2x - y - z = 11 \\
3x + 2y + z = -5 \\
\end{multline}
\tag{1}\]</span></span></p>
<p>In algebra, such systems can be solved several ways, for instance by isolating one or more variables and substituting, or geometrically (particularly for 2D systems, by plotting the lines and looking for the intersection). Once there are more than a few variables however, the only manageable way to solve them is with matrix operations, or more explicitly, linear algebra. <strong>This sort of problem is the core of linear algebra, and the reason the field is called linear algebra.</strong></p>
<p>To solve the system above using linear algebra, we have to write it in the form of matrices and column vectors:</p>
<p><span id="eq-2"><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -3 \\ 2 &amp; -1 &amp; -1 \\ 3 &amp; 2 &amp; 1 \\
\end{bmatrix}
\begin{bmatrix}
x \\ y \\ z
\end{bmatrix} =
\begin{bmatrix}
3 \\ 11 \\ -5
\end{bmatrix}
\tag{2}\]</span></span></p>
<p>or more generally</p>
<p><span id="eq-3"><span class="math display">\[
\mathbf{A}\mathbf{x} = \mathbf{b}
\tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{A}\)</span> is the matrix of coefficients, <span class="math inline">\(\mathbf{x}\)</span> is the column vector of variable names<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and <span class="math inline">\(\mathbf{b}\)</span> is a column vector of constants. Notice that these matrices are conformable:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span id="eq-4"><span class="math display">\[
\mathbf{A}^{3 \times 3}\mathbf{x}^{3 \times 1} = \mathbf{b}^{3 \times 1}
\tag{4}\]</span></span></p>
<p>To solve such a system, when we have <span class="math inline">\(n\)</span> unknowns, we need <span class="math inline">\(n\)</span> equations.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <em>This means that <span class="math inline">\(\mathbf{A}\)</span> has to be a square matrix, and square matrices play a special role in linear algebra.</em> I’m not sure this point is always conveyed clearly when this material is introduced.</p>
<p>To find the values of <span class="math inline">\(\mathbf{x} = x, y, z\)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, we can do a little rearranging following the rules of linear algebra and matrix operations. First we pre-multiply both sides by the inverse of <span class="math inline">\(\mathbf{A}\)</span>, which then gives us the identity matrix <span class="math inline">\(\mathbf{I}\)</span>, which drops out.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p><span id="eq-5"><span class="math display">\[
\mathbf{A}^{-1}\mathbf{A}\mathbf{x} = \mathbf{I}\mathbf{x} = \mathbf{x} = \mathbf{A}^{-1}\mathbf{b}
\tag{5}\]</span></span></p>
<p>So it’s all sounding pretty simple right? Ha. This is actually where things break down. For this to work, <span class="math inline">\(\mathbf{A}\)</span> must be invertible, which is not always the case.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> If there is no inverse, then the system of equations either has no solution or infinite solutions. <em>So finding the inverse of a matrix, or discovering it doesn’t exist, is essential to solving these systems of linear equations.</em> More on this eventually, but for now, <em>we know <span class="math inline">\(\mathbf{A}\)</span> must be a square matrix and we hope it is invertible.</em></p>
<section id="r-functions" class="level3">
<h3 class="anchored" data-anchor-id="r-functions">R Functions</h3>
</section>
</section>
<section id="a-key-application" class="level2">
<h2 class="anchored" data-anchor-id="a-key-application">A Key Application</h2>
<p>We learn in algebra that a line takes the form <span class="math inline">\(y = mx + b\)</span>. If one has measurements in the form of <span class="math inline">\(x, y\)</span> pairs that one expects to fit to a line, we need linear regression. Carrying out a linear regression is arguably one of the most important, and certainly a very common application of the linear systems described above. One can get the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> by hand using algebra, but any computer will solve the system using a matrix approach.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> Consider this data:</p>
<p><span id="eq-6"><span class="math display">\[
\begin{matrix}
x &amp; y \\
2.1 &amp; 11.8 \\
0.9 &amp; 7.2 \\
3.9 &amp; 21.5 \\
3.2 &amp; 17.2 \\
5.1 &amp; 26.8 \\
\end{matrix}
\tag{6}\]</span></span></p>
<p>To express this in a matrix form, we would recast</p>
<p><span id="eq-6"><span class="math display">\[
y = mx + b
\tag{7}\]</span></span></p>
<p>into</p>
<p><span id="eq-10"><span class="math display">\[
\mathbf{y} = \mathbf{X}\mathbf{\beta} + \mathbf{\epsilon}
\tag{8}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{y}\)</span> is the column vector of <span class="math inline">\(y\)</span> values. That seems sensible.</li>
<li><span class="math inline">\(\mathbf{X}\)</span> is a matrix composed of a column of ones plus a column of the <span class="math inline">\(x\)</span> values. This is called a <a href="https://en.wikipedia.org/wiki/Design_matrix#Simple_linear_regression">design matrix</a>. At least here <span class="math inline">\(\mathbf{X}\)</span> contains only <span class="math inline">\(x\)</span> values as variables.</li>
<li><span class="math inline">\(\mathbf{\beta}\)</span> is a column vector of coefficients (including, as we will see, the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> if we are thinking back <span class="math inline">\(y = mx + b\)</span>).</li>
<li><span class="math inline">\(\mathbf{\epsilon}\)</span> is new, it is a column vector giving the errors at each point.</li>
</ul>
<p>With our data above, this looks like:</p>
<p><span id="eq-8"><span class="math display">\[
\begin{bmatrix}
11.8 \\
7.2 \\
21.5 \\
17.2 \\
26.8 \\
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 11.8 \\
1 &amp; 7.2 \\
1 &amp; 21.5 \\
1 &amp; 17.2 \\
1 &amp; 26.8 \\
\end{bmatrix}
\begin{bmatrix}
\beta_0 \\ \beta_1
\end{bmatrix}
+
\begin{bmatrix}
\epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \epsilon_4 \\ \epsilon_5
\end{bmatrix}
\tag{9}\]</span></span></p>
<p>If we multiply this out, each row works out to be an instance of <span class="math inline">\(y_i = \beta_1 x_i + \beta_0\)</span> so you can hopefully see that <span class="math inline">\(\beta_1\)</span> corresponds to <span class="math inline">\(m\)</span> and <span class="math inline">\(\beta_0\)</span> corresponds to <span class="math inline">\(b\)</span>.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<p>This looks similar to <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> seen in <a href="#eq-3">Equation&nbsp;3</a>, if you set <span class="math inline">\(\mathbf{A}\)</span> to <span class="math inline">\(\mathbf{X}\)</span>, <span class="math inline">\(\mathbf{x}\)</span> to <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\mathbf{b}\)</span> to <span class="math inline">\(\mathbf{y}\)</span>:</p>
<p><span id="eq-11"><span class="math display">\[
\begin{multline}
\mathbf{y} \approx \mathbf{X}\mathbf{\beta} \\
\mathbf{b} \approx \mathbf{A}\mathbf{x} \\
\end{multline}
\tag{10}\]</span></span></p>
<p>This contortion of symbols is pretty fubar’d but actually we can salvage it.</p>
<p>The difference is that being composed of real data, presumably with measurement errors, there is not an exact solution to <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> due to the error term. There is however, an approximate solution, which is what is meant when we say we are looking for the line of best fit. This is how linear regression is carried out on a computer. The relevant equation is:</p>
<p><span id="eq-9"><span class="math display">\[
\hat{\beta} = (\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}y
\tag{11}\]</span></span></p>
<p>The key point here is that once again we need to invert a matrix to solve this. The details of where <a href="#eq-9">Equation&nbsp;11</a> comes from are covered in a number of places (but I will add here that <span class="math inline">\(\hat{\beta}\)</span> refers to the best estimate of <span class="math inline">\(\beta\)</span>).</p>
<section id="r-functions-1" class="level3">
<h3 class="anchored" data-anchor-id="r-functions-1">R Functions</h3>
<p>(Singh 1.8.4). So finding the inverse is important. If there is no inverse then the system of equations either has no solutions or infinite solutions (Singh pg 115, also section 1.7.2 for graphical definition, BS 3.2).</p>


</section>
</section>


<script data-goatcounter="https://chemospec.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Here we have the slightly unfortunate circumstance where symbol conventions cannot be completely harmonized. We are saying that <span class="math inline">\(\mathbf{x} = x, y, z\)</span> which seems a bit silly since vector <span class="math inline">\(\mathbf{x}\)</span> contains <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> components in addition to <span class="math inline">\(x\)</span>. I ask you to accept this for two reasons: First, most linear algebra texts use the symbols in <a href="#eq-3">Equation&nbsp;3</a> as the general form for this topic, so if you go to study this further that’s what you’ll find. Second, I feel like using <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> in <a href="#eq-1">Equation&nbsp;1</a> will be familar to the most people. If you want to get rid of this infelicity, then you have to write <a href="#eq-1">Equation&nbsp;1</a> (in part) as <span class="math inline">\(x_1 + 2x_2 + 3x_3 = 3\)</span> which I think clouds the interpretation. Perhaps however you feel my choices are equally bad.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Conformable means that the number of columns in the first matrix equals the number of rows in the second matrix. This is necessary because of the dot product definition of matrix multiplication. More details <a href="https://chemospec.org/posts/2022-08-14-Linear-Alg-Notes/2022-08-14-Linear-Alg-Notes.html">here</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Remember “story problems” where you had to read closely to express what was given in terms of equations, and find enough equations? “If Sally bought 10 pieces of candy and a drink for $1.50…”<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>We could also write this as <span class="math inline">\(\mathbf{x} = (x, y, z)^\mathsf{T}\)</span> to emphasize that it is a column vector. One might prefer this because the only vector one can write in a row of text is a row vector, so if we mean a column vector we ought to show it transposed.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The inverse of a matrix is analogous to dividing a variable by itself, since it leads to that variable canceling out and thus simplifying the equation. However, strictly speaking there is no operation that qualifies as division in the matrix world.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>For a matrix <span class="math inline">\(\mathbf{A}\)</span> to be invertible, there must exist another matrix <span class="math inline">\(\mathbf{B}\)</span> such that $ = <span class="math inline">\(\mathbf{B}\mathbf{A} = 1\)</span>. However, this definition doesn’t offer any clues about how we might find the inverse.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>A very good discussion of the algebraic approach is available <a href="https://en.wikipedia.org/wiki/Simple_linear_regression#Fitting_the_regression_line">here</a>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>This is another example of an infelicity of symbol conventions. The typical math/statistics text symbols are not the same as the symbols a student in Physics 101 would likely encounter.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{hanson2022,
  author = {Bryan Hanson},
  editor = {},
  title = {Notes on {Linear} {Algebra} {Part} 2},
  date = {2022-08-14},
  url = {http://chemospec.org/posts/2022-08-30-Linear-Alg-Notes-Pt2/2022-08-30-Linear-Alg-Notes-Pt2.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-hanson2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Bryan Hanson. 2022. <span>“Notes on Linear Algebra Part 2.”</span>
August 14, 2022. <a href="http://chemospec.org/posts/2022-08-30-Linear-Alg-Notes-Pt2/2022-08-30-Linear-Alg-Notes-Pt2.html">http://chemospec.org/posts/2022-08-30-Linear-Alg-Notes-Pt2/2022-08-30-Linear-Alg-Notes-Pt2.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="bryanhanson/CSR" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>



</body></html>