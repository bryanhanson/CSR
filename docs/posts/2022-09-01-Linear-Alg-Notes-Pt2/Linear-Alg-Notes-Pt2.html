<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bryan Hanson">
<meta name="dcterms.date" content="2022-09-01">
<meta name="description" content="Motivations - Bushwhacking through the thicket of linear algebra">

<title>Chemometrics and Spectroscopy Using R - Notes on Linear Algebra Part 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Chemometrics and Spectroscopy Using R - Notes on Linear Algebra Part 2">
<meta name="twitter:description" content="Motivations - Bushwhacking through the thicket of linear algebra">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chemometrics and Spectroscopy Using R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.r-bloggers.com/">
 <span class="menu-text">R-Bloggers</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:hanson@depauw.edu"><i class="bi bi-envelope-fill" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/profbryanhanson"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bryanhanson"><i class="bi bi-git" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#systems-of-equations" id="toc-systems-of-equations" class="nav-link active" data-scroll-target="#systems-of-equations">Systems of Equations</a></li>
  <li><a href="#a-key-application-linear-regression" id="toc-a-key-application-linear-regression" class="nav-link" data-scroll-target="#a-key-application-linear-regression">A Key Application: Linear Regression</a></li>
  <li><a href="#inverting-matrices" id="toc-inverting-matrices" class="nav-link" data-scroll-target="#inverting-matrices">Inverting Matrices</a></li>
  <li><a href="#r-functions" id="toc-r-functions" class="nav-link" data-scroll-target="#r-functions">R Functions</a>
  <ul class="collapse">
  <li><a href="#inverting-matrices-1" id="toc-inverting-matrices-1" class="nav-link" data-scroll-target="#inverting-matrices-1">Inverting Matrices</a></li>
  <li><a href="#solving-systems-of-linear-equations" id="toc-solving-systems-of-linear-equations" class="nav-link" data-scroll-target="#solving-systems-of-linear-equations">Solving Systems of Linear Equations</a></li>
  <li><a href="#computing-linear-regression" id="toc-computing-linear-regression" class="nav-link" data-scroll-target="#computing-linear-regression">Computing Linear Regression</a></li>
  </ul></li>
  <li><a href="#annotated-bibliography" id="toc-annotated-bibliography" class="nav-link" data-scroll-target="#annotated-bibliography">Annotated Bibliography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notes on Linear Algebra Part 2</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Linear Algebra</div>
  </div>
  </div>

<div>
  <div class="description">
    Motivations - Bushwhacking through the thicket of linear algebra
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bryan Hanson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 1, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="tldr" class="level4">
<h4 class="anchored" data-anchor-id="tldr">TL;DR</h4>
<ul>
<li>Linear algebra is complex. We need a way to penetrate the thicket. Here’s one.</li>
<li>Linear systems of equations are at the heart, not surprisingly, of linear algebra.</li>
<li>A key application is linear regression, which has a matrix solution.</li>
<li>Solving the needed equations requires inverting a matrix.</li>
<li>Inverting a matrix is more easily done after decomposing the matrix into upper and lower triangular matrices.</li>
<li>The upper and lower triangular matrices are individually easy to invert, giving access to the inverse of the original matrix.</li>
<li>Changes in notations and symbols as you move between presentations add significantly to the cognitive burden in learning this material.</li>
</ul>
<hr>
<p>For Part 1 of this series, see <a href="https://chemospec.org/posts/2022-08-14-Linear-Alg-Notes/2022-08-14-Linear-Alg-Notes.html">here</a>.</p>
<p>If you open a linear algebra text, it’s quickly apparent how complex the field is. There are so many special types of matrices, so many different decompositions of matrices. Why are all these needed? Should I care about null spaces? What’s really important? What are the threads that tie the different concepts together? As someone who is trying to improve their understanding of the field, especially with regard to its applications in chemometrics, it can be a tough slog.</p>
<p>In this post I’m going to try to demonstrate how some simple chemometric tasks can be solved using linear algebra. Though I cover some math here, the math is secondary right now – the conceptual connections are more important. I’m more interested in finding (and sharing) a path through the thicket of linear algebra. We can return as needed to expand the basic math concepts. The cognitive effort to work through the math details is likely a lot lower if we have a sense of the big picture.</p>
<p>In this post, matrices, including row and column vectors, will be shown in bold e.g.&nbsp;<span class="math inline">\(\mathbf{A}\)</span> while scalars and variables will be shown in script, e.g.&nbsp;<span class="math inline">\(n\)</span>. Variables used in <code>R</code> code will appear like <code>A</code>.</p>
</section>
<section id="systems-of-equations" class="level2">
<h2 class="anchored" data-anchor-id="systems-of-equations">Systems of Equations</h2>
<p>If you’ve had algebra, you have certainly run into “system of equations” such as the following:</p>
<p><span id="eq-1"><span class="math display">\[
\begin{multline}
x + 2y -3z = 3 \\
2x - y - z = 11 \\
3x + 2y + z = -5 \\
\end{multline}
\tag{1}\]</span></span></p>
<p>In algebra, such systems can be solved several ways, for instance by isolating one or more variables and substituting, or geometrically (particularly for 2D systems, by plotting the lines and looking for the intersection). Once there are more than a few variables however, the only manageable way to solve them is with matrix operations, or more explicitly, linear algebra. <em>This sort of problem is the core of linear algebra, and the reason the field is called linear algebra.</em></p>
<p>To solve the system above using linear algebra, we have to write it in the form of matrices and column vectors:</p>
<p><span id="eq-2"><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -3 \\ 2 &amp; -1 &amp; -1 \\ 3 &amp; 2 &amp; 1 \\
\end{bmatrix}
\begin{bmatrix}
x \\ y \\ z
\end{bmatrix} =
\begin{bmatrix}
3 \\ 11 \\ -5
\end{bmatrix}
\tag{2}\]</span></span></p>
<p>or more generally</p>
<p><span id="eq-3"><span class="math display">\[
\mathbf{A}\mathbf{x} = \mathbf{b}
\tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{A}\)</span> is the matrix of coefficients, <span class="math inline">\(\mathbf{x}\)</span> is the column vector of variable names<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and <span class="math inline">\(\mathbf{b}\)</span> is a column vector of constants. Notice that these matrices are conformable:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span id="eq-4"><span class="math display">\[
\mathbf{A}^{3 \times 3}\mathbf{x}^{3 \times 1} = \mathbf{b}^{3 \times 1}
\tag{4}\]</span></span></p>
<p>To solve such a system, when we have <span class="math inline">\(n\)</span> unknowns, we need <span class="math inline">\(n\)</span> equations.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <em>This means that <span class="math inline">\(\mathbf{A}\)</span> has to be a square matrix, and square matrices play a special role in linear algebra.</em> I’m not sure this point is always conveyed clearly when this material is introduced. In fact, it seems like many texts on linear algebra seem to bury the lede.</p>
<p>To find the values of <span class="math inline">\(\mathbf{x} = x, y, z\)</span><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, we can do a little rearranging following the rules of linear algebra and matrix operations. First we pre-multiply both sides by the inverse of <span class="math inline">\(\mathbf{A}\)</span>, which then gives us the identity matrix <span class="math inline">\(\mathbf{I}\)</span>, which drops out.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p><span id="eq-5"><span class="math display">\[
\mathbf{A}^{-1}\mathbf{A}\mathbf{x} = \mathbf{I}\mathbf{x} = \mathbf{x} = \mathbf{A}^{-1}\mathbf{b}
\tag{5}\]</span></span></p>
<p>So it’s all sounding pretty simple right? Ha. This is actually where things potentially break down. For this to work, <span class="math inline">\(\mathbf{A}\)</span> must be invertible, which is not always the case.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> If there is no inverse, then the system of equations either has no solution or infinite solutions. <em>So finding the inverse of a matrix, or discovering it doesn’t exist, is essential to solving these systems of linear equations.</em><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> More on this eventually, but for now, <em>we know <span class="math inline">\(\mathbf{A}\)</span> must be a square matrix and we hope it is invertible.</em></p>
</section>
<section id="a-key-application-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="a-key-application-linear-regression">A Key Application: Linear Regression</h2>
<p>We learn in algebra that a line takes the form <span class="math inline">\(y = mx + b\)</span>. If one has measurements in the form of <span class="math inline">\(x, y\)</span> pairs that one expects to fit to a line, we need linear regression. Carrying out a linear regression is arguably one of the most important, and certainly a very common application of the linear systems described above. One can get the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> by hand using algebra, but any computer will solve the system using a matrix approach.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Consider this data:</p>
<p><span id="eq-6"><span class="math display">\[
\begin{matrix}
x &amp; y \\
2.1 &amp; 11.8 \\
0.9 &amp; 7.2 \\
3.9 &amp; 21.5 \\
3.2 &amp; 17.2 \\
5.1 &amp; 26.8 \\
\end{matrix}
\tag{6}\]</span></span></p>
<p>To express this in a matrix form, we recast</p>
<p><span id="eq-12"><span class="math display">\[
y = mx + b
\tag{7}\]</span></span></p>
<p>into</p>
<p><span id="eq-10"><span class="math display">\[
\mathbf{y} = \mathbf{X}\mathbf{\beta} + \mathbf{\epsilon}
\tag{8}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{y}\)</span> is the column vector of <span class="math inline">\(y\)</span> values. That seems sensible.</li>
<li><span class="math inline">\(\mathbf{X}\)</span> is a matrix composed of a column of ones plus a column of the <span class="math inline">\(x\)</span> values. This is called a <a href="https://en.wikipedia.org/wiki/Design_matrix#Simple_linear_regression">design matrix</a>. At least here <span class="math inline">\(\mathbf{X}\)</span> contains only <span class="math inline">\(x\)</span> values as variables.</li>
<li><span class="math inline">\(\mathbf{\beta}\)</span> is a column vector of coefficients (including, as we will see, the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> if we are thinking back <span class="math inline">\(y = mx + b\)</span>).</li>
<li><span class="math inline">\(\mathbf{\epsilon}\)</span> is new, it is a column vector giving the errors at each point.</li>
</ul>
<p>With our data above, this looks like:</p>
<p><span id="eq-8"><span class="math display">\[
\begin{bmatrix}
11.8 \\
7.2 \\
21.5 \\
17.2 \\
26.8 \\
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 2.1 \\
1 &amp; 0.9 \\
1 &amp; 3.9 \\
1 &amp; 3.2 \\
1 &amp; 5.1 \\
\end{bmatrix}
\begin{bmatrix}
\beta_0 \\ \beta_1
\end{bmatrix}
+
\begin{bmatrix}
\epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \epsilon_4 \\ \epsilon_5
\end{bmatrix}
\tag{9}\]</span></span></p>
<p>If we multiply this out, each row works out to be an instance of <span class="math inline">\(y_i = \beta_1 x_i + \beta_0\)</span>. Hopefully you can appreciate that <span class="math inline">\(\beta_1\)</span> corresponds to <span class="math inline">\(m\)</span> and <span class="math inline">\(\beta_0\)</span> corresponds to <span class="math inline">\(b\)</span>.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<p>This looks similar to <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> seen in <a href="#eq-3">Equation&nbsp;3</a>, if you set <span class="math inline">\(\mathbf{b}\)</span> to <span class="math inline">\(\mathbf{y}\)</span>, <span class="math inline">\(\mathbf{A}\)</span> to <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{x}\)</span> to <span class="math inline">\(\beta\)</span>:</p>
<p><span id="eq-11"><span class="math display">\[
\begin{align}
\mathbf{b} &amp;\approx \mathbf{A}\mathbf{x} \\
\downarrow &amp;\phantom{\approx} \; \downarrow \; \downarrow \\
\mathbf{y} &amp;\approx \mathbf{X}\mathbf{\beta} \\
\end{align}
\tag{10}\]</span></span></p>
<p>This contortion of symbols is pretty nasty, but honestly not uncommon when moving about in the world of linear algebra.</p>
<p>As it is composed of real data, presumably with measurement errors, there is not an exact solution to <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> due to the error term. There is however, an approximate solution, which is what is meant when we say we are looking for the line of best fit. This is how linear regression is carried out on a computer. The relevant equation is:</p>
<p><span id="eq-9"><span class="math display">\[
\hat{\beta} = (\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}y
\tag{11}\]</span></span></p>
<p>The key point here is that once again we need to invert a matrix to solve this. The details of where <a href="#eq-9">Equation&nbsp;11</a> comes from are covered in a number of places, but I will note here that <span class="math inline">\(\hat{\beta}\)</span> refers to the best estimate of <span class="math inline">\(\beta\)</span>.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
</section>
<section id="inverting-matrices" class="level2">
<h2 class="anchored" data-anchor-id="inverting-matrices">Inverting Matrices</h2>
<p>We now have two examples where inverting a matrix is a key step: solving a system of linear equations, and approximating the solution to a system of linear equations (the regression case). These cases are not outliers, the ability to invert a matrix is very important. So how do we do this? The LU decomposition can do it, and is widely used so worth spending some time on. A decomposition is the process of breaking a matrix into pieces that are easier to handle, or that give us special insight, or both. If you are a chemometrician you have almost certainly carried out Principal Components Analysis (PCA). Under the hood, PCA requires either a singular value decomposition, or an eigen decomposition (more info <a href="https://bryanhanson.github.io/LearnPCA/">here</a>).</p>
<p>So, about the LU decomposition: it breaks a matrix into two matrices, <span class="math inline">\(\mathbf{L}\)</span>, a “lower triangular matrix”, and <span class="math inline">\(\mathbf{U}\)</span>, an “upper triangular matrix”. These special matrices contain only zeros except along the diagonal and the entries below it (in the lower case), or along the diagonal and the entries above it (in the upper case). The advantage of triangular matrices is that they are very easy to invert (all those zeros make many terms drop out). So the LU decomposition breaks the tough job of inverting <span class="math inline">\(\mathbf{A}\)</span> into two easier jobs.</p>
<p><span id="eq-12"><span class="math display">\[
\begin{align}
\mathbf{A} &amp;= \mathbf{L}\mathbf{U} \\
\mathbf{A}^{-1} &amp;= (\mathbf{L}\mathbf{U})^{-1} \\
\mathbf{A}^{-1} &amp;= \mathbf{U}^{-1}\mathbf{L}^{-1} \\
\end{align}
\tag{12}\]</span></span></p>
<p>When all is done, we only need to figure out <span class="math inline">\(\mathbf{U}^{-1}\)</span> and <span class="math inline">\(\mathbf{L}^{-1}\)</span> which as mentioned is straightforward.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p>To summarize, if we want to solve a system of equations we need to carry out matrix inversion, which is turn is much easier to do if one uses the LU decomposition to get two easy to invert triangular matrices. I hope you are beginning to see how pieces of linear algebra fit together, and why it might be good to learn more.</p>
</section>
<section id="r-functions" class="level2">
<h2 class="anchored" data-anchor-id="r-functions">R Functions</h2>
<section id="inverting-matrices-1" class="level3">
<h3 class="anchored" data-anchor-id="inverting-matrices-1">Inverting Matrices</h3>
<p>Let’s look at how <code>R</code> does these operations, and check our understanding along the way. <code>R</code> makes this really easy. We’ll start with the issue of invertibility. Let’s create a matrix for testing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">5</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>A1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    3   11   -5
[2,]    5    2    2
[3,]   -1    0    5</code></pre>
</div>
</div>
<p>In the <code>matlib</code> package there is a function <code>inv</code> that inverts matrices. It returns the inverted matrix, which we can verify by multiplying the inverted matrix by the original matrix to give the identity matrix (if inversion was successful). <code>diag(3)</code> creates a 3 x 3 matrix with 1’s on the diagonal, in other words an identity matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(<span class="st">"matlib"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>A1_inv <span class="ot">&lt;-</span> <span class="fu">inv</span>(A1)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">all.equal</span>(A1_inv <span class="sc">%*%</span> A1, <span class="fu">diag</span>(<span class="dv">3</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean relative difference: 8.999999e-08"</code></pre>
</div>
</div>
<p>The difference here is really small, but not zero. Let’s use a different function, <code>solve</code> which is part of base <code>R</code>. If <code>solve</code> is given a single matrix, it returns the inverse of that matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>A1_solve <span class="ot">&lt;-</span> <span class="fu">solve</span>(A1) <span class="sc">%*%</span> A1</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">all.equal</span>(A1_solve, <span class="fu">diag</span>(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>That’s a better result. Why are there differences? <code>inv</code> uses a method called Gaussian elimination which is similar to how one would invert a matrix using pencil and paper. On the other hand, <code>solve</code> uses the LU decomposition discussed earlier, and no matrix inversion is necessary. Looks like the LU decomposition gives a somewhat better numerical result.</p>
<p>Now let’s look at a different matrix, created by replacing the third column of <code>A1</code> with different values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>A2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    3   11    6
[2,]    5    2   10
[3,]   -1    0   -2</code></pre>
</div>
</div>
<p>And let’s compute its inverse using <code>solve</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">solve</span>(A2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in solve.default(A2): system is computationally singular: reciprocal condition number = 6.71337e-19</code></pre>
</div>
</div>
<p>When <code>R</code> reports that <code>A2</code> is computationally singular, it is saying that it cannot be inverted. Why not? If you look at <code>A2</code>, notice that column 3 is a multiple of column 1. Anytime one column is a multiple of another, or one row is a multiple of another, then the matrix cannot be inverted because the rows or columns are not independent.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> If this was a matrix of coefficients from an experimental measurement of variables, this would mean that some of your variables are not independent, they must be measuring the same underlying phenomenon.</p>
</section>
<section id="solving-systems-of-linear-equations" class="level3">
<h3 class="anchored" data-anchor-id="solving-systems-of-linear-equations">Solving Systems of Linear Equations</h3>
<p>Let’s solve the system from <a href="#eq-2">Equation&nbsp;2</a>. It turns out that the <code>solve</code> function also handles this case, if you give it two arguments. Remember, <code>solve</code> is using the LU decomposition behind the scenes, no matrix inversion is required.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>A3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    2   -3
[2,]    2   -1   -1
[3,]    3    2    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">colnames</span>(A3) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>) <span class="co"># naming the columns will label the answer</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">11</span>, <span class="sc">-</span><span class="dv">5</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">solve</span>(A3, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> x  y  z 
 2 -4 -3 </code></pre>
</div>
</div>
<p>The answer is the values of <span class="math inline">\(x, y, z\)</span> that make the system of equations true.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
How does LU decomposition avoid inversion?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>While we’ve emphasized the importance and challenges of inverting matrices, we’ve also pointed out that to solve a linear system there are alternatives to looking at the problem from the perspective of <a href="#eq-5">Equation&nbsp;5</a>. Here’s an approach using the LU decomposition, starting with substituting <span class="math inline">\(\mathbf{A}\)</span> with <span class="math inline">\(\mathbf{L}\mathbf{U}\)</span>:</p>
<p><span id="eq-20"><span class="math display">\[
\mathbf{A}\mathbf{x} = \mathbf{L}\mathbf{U}\mathbf{x} = \mathbf{b}
\tag{13}\]</span></span></p>
<p>We want to solve for <span class="math inline">\(\mathbf{x}\)</span> the column vector of variables. To do so, define a new vector <span class="math inline">\(\mathbf{y} = \mathbf{U}\mathbf{x}\)</span> and substitute it in:</p>
<p><span id="eq-21"><span class="math display">\[
\mathbf{L}\mathbf{U}\mathbf{x} = \mathbf{L}\mathbf{y} = \mathbf{b}
\tag{14}\]</span></span></p>
<p>Next we solve for <span class="math inline">\(\mathbf{y}\)</span>. One way we could do this is to pre-multiply both sides by <span class="math inline">\(\mathbf{L}^{-1}\)</span> but we are looking for a way to avoid using the inverse. Instead, we evaluate <span class="math inline">\(\mathbf{L}\mathbf{y}\)</span> to give a series of expressions using the dot product (in other words plain matrix multiplication). Because <span class="math inline">\(\mathbf{L}\)</span> is lower triangular, many of the terms we might have gotten actually disappear because of the zero coefficients. What remains is simple enough that we can algebraically find each element of <span class="math inline">\(\mathbf{y}\)</span> starting from the first row (this is called forward substitution). Once we have <span class="math inline">\(\mathbf{y}\)</span>, we can find <span class="math inline">\(\mathbf{x}\)</span> by solving <span class="math inline">\(\mathbf{y} = \mathbf{U}\mathbf{x}\)</span> using a similar approach, but working from the last row upward (this is backward substitution). This is a good illustration of the utility of triangular matrices: some operations can move from the linear algebra realm to the algebra realm. <a href="https://en.wikipedia.org/wiki/Triangular_matrix#Forward_and_back_substitution">Wikipedia</a> has a good illustration of forward and backward substitution.</p>
</div>
</div>
</div>
</section>
<section id="computing-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="computing-linear-regression">Computing Linear Regression</h3>
<p>Let’s compute the values for <span class="math inline">\(m, b\)</span> in our regression data shown in <a href="#eq-6">Equation&nbsp;6</a>. First, let’s set up the needed matrices and plot the data since visualizing the data is always a good idea.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>y <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">11.8</span>, <span class="fl">7.2</span>, <span class="fl">21.5</span>, <span class="fl">17.2</span>, <span class="fl">26.8</span>), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="fl">2.1</span>, <span class="fl">0.9</span>, <span class="fl">3.9</span>, <span class="fl">3.2</span>, <span class="fl">5.1</span>), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="co"># design matrix</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1  2.1
[2,]    1  0.9
[3,]    1  3.9
[4,]    1  3.2
[5,]    1  5.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">plot</span>(X[,<span class="dv">2</span>], y, <span class="at">xlab =</span> <span class="st">"x"</span>) <span class="co"># column 2 of X has the x values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Linear-Alg-Notes-Pt2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The value of <span class="math inline">\(\hat{\beta}\)</span> can be found via <a href="#eq-9">Equation&nbsp;11</a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">solve</span>((<span class="fu">t</span>(X) <span class="sc">%*%</span> X)) <span class="sc">%*%</span>  <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 2.399618
[2,] 4.769862</code></pre>
</div>
</div>
<p>The first value is for <span class="math inline">\(b\)</span> or <span class="math inline">\(\beta_0\)</span> or intecept, the second value is for <span class="math inline">\(m\)</span> or <span class="math inline">\(\beta_1\)</span> or slope.</p>
<p>Let’s compare this answer to <code>R</code>’s built-in <code>lm</code> function (for linear model):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X[,<span class="dv">2</span>])</span>
<span id="cb20-2"><a href="#cb20-2"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ X[, 2])

Coefficients:
(Intercept)       X[, 2]  
       2.40         4.77  </code></pre>
</div>
</div>
<p>We have good agreement! If you care to learn about the goodness of the fit, the residuals etc, then you can look at the help file <code>?lm</code> and <code>str(fit)</code>. <code>lm</code> returns pretty much all one needs to know about the results, but if you wish to calculate all the interesting values yourself you can do so by manipulating <a href="#eq-9">Equation&nbsp;11</a> and its relatives.</p>
<p>Finally, let’s plot the line of best fit found by <code>lm</code> to make sure everything looks reasonable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">plot</span>(X[,<span class="dv">2</span>], y, <span class="at">xlab =</span> <span class="st">"x"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">abline</span>(<span class="at">coef =</span> <span class="fu">coef</span>(fit), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Linear-Alg-Notes-Pt2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<p>That’s all for now, and a lot to digest. I hope you are closer to finding your own path through linear algebra. Remember that investing in learning the fundamentals prepares you for tackling the more complex topics. Thanks for reading!</p>
</section>
</section>
<section id="annotated-bibliography" class="level2">
<h2 class="anchored" data-anchor-id="annotated-bibliography">Annotated Bibliography</h2>
<p>These are the main sources I relied on for this post.</p>
<ul>
<li><em>The No Bullshit Guide to Linear Algebra</em> by <a href="https://minireference.com">Ivan Savov</a>.
<ul>
<li>Section 1.15: Solving systems of linear equations.</li>
<li>Section 6.6: LU decomposition.</li>
</ul></li>
<li><em>Linear Algebra: step by step</em> by Kuldeep Singh, Oxford Univerity Press, 2014.
<ul>
<li>Section 1.8.5: Singluar (non-invertible) matrices mean there is no solution or infinite solutions to the linear system. For graphical illustration see sections 1.1.3 and 1.7.2.</li>
<li>Section 1.6.4: Definition of the inverse and conceptual meaning.</li>
<li>Section 1.8.4: Solving linear systems when <span class="math inline">\(\mathbf{A}\)</span> is invertible.</li>
<li>Section 6.4: LU decomposition.</li>
<li>Section 6.4.3: Solving linear systems without using inversion, via the LU decomposition.</li>
</ul></li>
<li><em>Linear Models with R</em> by Julian J. Faraway, Chapman and Hall/CRC, 2005.
<ul>
<li>Sections 2.1-2.4: Linear regression from the algebraic and matrix perspectives, derivation of <a href="#eq-9">Equation&nbsp;11</a>.</li>
</ul></li>
<li>The vignettes of the <code>matlib</code> package are very helpful.</li>
</ul>


</section>


<script data-goatcounter="https://chemospec.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Here we have the slightly unfortunate circumstance where symbol conventions cannot be completely harmonized. We are saying that <span class="math inline">\(\mathbf{x} = x, y, z\)</span> which seems a bit silly since vector <span class="math inline">\(\mathbf{x}\)</span> contains <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> components in addition to <span class="math inline">\(x\)</span>. I ask you to accept this for two reasons: First, most linear algebra texts use the symbols in <a href="#eq-3">Equation&nbsp;3</a> as the general form for this topic, so if you go to study this further that’s what you’ll find. Second, I feel like using <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> in <a href="#eq-1">Equation&nbsp;1</a> will be familar to the most people. If you want to get rid of this infelicity, then you have to write <a href="#eq-1">Equation&nbsp;1</a> (in part) as <span class="math inline">\(x_1 + 2x_2 + 3x_3 = 3\)</span> which I think clouds the interpretation. Perhaps however you feel my choices are equally bad.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Conformable means that the number of columns in the first matrix equals the number of rows in the second matrix. This is necessary because of the dot product definition of matrix multiplication. More details <a href="https://chemospec.org/posts/2022-08-14-Linear-Alg-Notes/2022-08-14-Linear-Alg-Notes.html">here</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Remember “story problems” where you had to read closely to express what was given in terms of equations, and find enough equations? “If Sally bought 10 pieces of candy and a drink for $1.50…”<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>We could also write this as <span class="math inline">\(\mathbf{x} = (x, y, z)^\mathsf{T}\)</span> to emphasize that it is a column vector. One might prefer this because the only vector one can write in a row of text is a row vector, so if we mean a column vector many people would prefer to write it transposed.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The inverse of a matrix is analogous to dividing a variable by itself, since it leads to that variable canceling out and thus simplifying the equation. However, strictly speaking there is no operation that qualifies as division in the matrix world.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>For a matrix <span class="math inline">\(\mathbf{A}\)</span> to be invertible, there must exist another matrix <span class="math inline">\(\mathbf{B}\)</span> such that <span class="math inline">\(\mathbf{A}\mathbf{B} = \mathbf{B}\mathbf{A} = \mathbf{I}\)</span>. However, this definition doesn’t offer any clues about how we might find the inverse.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>In truth, there are other ways to solve <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> that don’t require inversion of a matrix. However, if a matrix <span class="math inline">\(\mathbf{A}\)</span> isn’t invertible, these other methods will also break down. We’ll demonstrate this later when we talk about the LU decomposition.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>A very good discussion of the algebraic approach is available <a href="https://en.wikipedia.org/wiki/Simple_linear_regression#Fitting_the_regression_line">here</a>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>This is another example of an infelicity of symbol conventions. The typical math/statistics text symbols are not the same as the symbols a student in Physics 101 would likely encounter.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The careful reader will note that the data set shown in <a href="#eq-8">Equation&nbsp;9</a> is not square, there are more observations (rows) than variables (columns). This is fine and desireable for a linear regression, we don’t want to use just two data points as that would have no error but not necessarily be accurate. However, only square matrices have inverses, so what’s going on here? In practice, what’s happening is we are using something called a pseudoinverse. The first part of the right side of <a href="#eq-9">Equation&nbsp;11</a> is in fact the pseudoinverse: <span class="math inline">\((\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}\)</span>. Perhaps we’ll cover this in a future post.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>The switch in the order of matrices on the last line of <a href="#eq-12">Equation&nbsp;12</a> is one of the properties of the inverse operator.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>This means that the rank of the matrix is less than the number of columns. You can get the rank of a matrix by counting the number of non-zero eigenvalues via <code>eigen(A2)$values</code>, which in this case gives 8.9330344, -5.9330344, -3.5953271^{-16}. There are only two non-zero values, so the rank is two. Perhaps in another post we’ll discuss this in more detail.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{hanson2022,
  author = {Bryan Hanson},
  title = {Notes on {Linear} {Algebra} {Part} 2},
  date = {2022-09-01},
  url = {http://chemospec.org/Linear-Alg-Notes-Pt2.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-hanson2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Bryan Hanson. 2022. <span>“Notes on Linear Algebra Part 2.”</span>
September 1, 2022. <a href="http://chemospec.org/Linear-Alg-Notes-Pt2.html">http://chemospec.org/Linear-Alg-Notes-Pt2.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="bryanhanson/CSR" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookies are used to track visits only</a></div></div>
  </div>
</footer>



</body></html>