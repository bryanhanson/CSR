<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bryan Hanson">
<meta name="dcterms.date" content="2022-08-14">
<meta name="description" content="When is a cross product not a cross product? Terminology run amok!">

<title>Chemometrics and Spectroscopy Using R - Notes on Linear Algebra Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Chemometrics and Spectroscopy Using R - Notes on Linear Algebra Part 1">
<meta name="twitter:description" content="When is a cross product not a cross product?  Terminology run amok!">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chemometrics and Spectroscopy Using R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html">Projects</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.r-bloggers.com/">R-Bloggers</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:hanson@depauw.edu"><i class="bi bi-envelope-fill" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/profbryanhanson"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bryanhanson"><i class="bi bi-git" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notes on Linear Algebra Part 1</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Linear Algebra</div>
  </div>
  </div>

<div>
  <div class="description">
    When is a cross product not a cross product? Terminology run amok!
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bryan Hanson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 14, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>If you are already familiar with much of linear algebra, as well as the relevant functions in <code>R</code>, read no further and do something else!</p>
<p>If you are like me, you’ve had <em>no</em> formal training in linear algebra, which means you learn what you need to when you need to use it. Eventually, you cobble together some hard-won knowledge. That’s good, because almost everything in chemometrics involves linear algebra.</p>
<p>This post is essentially a set of personal notes about the dot product and the cross product, two important manipulations in linear algebra. I’ve tried to harmonize things I learned way back in college physics and math courses, and integrate information I’ve found in various sources I have leaned on more recently. Without a doubt, the greatest impediment to really understanding this material is the use of multiple terminology and notations. I’m going to try really hard to be clear and to the point in my dicussion.</p>
<p>The main sources I’ve relied on are:</p>
<ul>
<li><em>The No Bullshit Guide to Linear Algebra</em> by <a href="https://minireference.com">Ivan Savov</a>. This is by far my favorite treatment of linear algebra. It gets to the point quickly.</li>
<li>The Wikipedia pages on <a href="https://en.wikipedia.org/wiki/Dot_product">dot product</a>, <a href="https://en.wikipedia.org/wiki/Cross_product">cross product</a> and <a href="https://en.wikipedia.org/wiki/Outer_product">outer product</a>.</li>
</ul>
<p>Let’s get started. For sanity and consistency, let’s define two 3D vectors and two matrices to illustrate our examples. Most of the time I’m going to write vectors with an arrow over the name, as a nod to the treatment usually given in a physics course. This reminds us that we are thinking about a quantity with direction and magnitude in some coordinate system, something geometric. Of course in the <code>R</code> language a vector is simply a list of numbers with the same data type; <code>R</code> doesn’t care if a vector is a vector in the geometric sense or a list of states.</p>
<p><span id="eq-def-u"><span class="math display">\[
\vec{u} = (u_x, u_y, u_z)
\tag{1}\]</span></span></p>
<p><span id="eq-def-v"><span class="math display">\[
\vec{v} = (v_x, v_y, v_z)
\tag{2}\]</span></span></p>
<p><span id="eq-def-A"><span class="math display">\[
\mathbf{A} =
\begin{bmatrix}
a_{11} &amp; a_{12} &amp; a_{13} \\
a_{21} &amp; a_{22} &amp; a_{23} \\
\end{bmatrix}
\tag{3}\]</span></span></p>
<p><span id="eq-def-B"><span class="math display">\[
\mathbf{B} =
\begin{bmatrix}
b_{11} &amp; b_{12} &amp; b_{13} \\
b_{21} &amp; b_{22} &amp; b_{23} \\
b_{31} &amp; b_{32} &amp; b_{33} \\
\end{bmatrix}
\tag{4}\]</span></span></p>
<section id="dot-product" class="level2">
<h2 class="anchored" data-anchor-id="dot-product">Dot Product</h2>
<section id="terminology" class="level3">
<h3 class="anchored" data-anchor-id="terminology">Terminology</h3>
<p>The dot product goes by these other names: inner product, scalar product. Typical notations include:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<ul>
<li><span class="math inline">\(\vec{u} \cdot \vec{v}\)</span> (the <span class="math inline">\(\cdot\)</span> is the origin of the name “dot” product)</li>
<li><span class="math inline">\(u \cdot v\)</span></li>
<li><span class="math inline">\(u^\mathsf{T}v\)</span> (when thinking of the vectors as column vectors)</li>
<li><span class="math inline">\(\langle u, v \rangle\)</span> (typically used when <span class="math inline">\(u, v\)</span> are complex)</li>
<li><span class="math inline">\(\langle u | v \rangle\)</span></li>
</ul>
</section>
<section id="formulas" class="level3">
<h3 class="anchored" data-anchor-id="formulas">Formulas</h3>
<p>There are two main formulas for the dot product with <em>vectors</em>, the algebraic formula (<a href="#eq-dp1">Equation&nbsp;5</a>) and the geometric formula (<a href="#eq-dp2">Equation&nbsp;6</a>).</p>
<p><span id="eq-dp1"><span class="math display">\[
\vec{u} \cdot \vec{v} = \sum{u_i v_i}
\tag{5}\]</span></span></p>
<p><span id="eq-dp2"><span class="math display">\[
\vec{u} \cdot \vec{v} = \| \vec{u} \| \| \vec{v} \| cos \theta
\tag{6}\]</span></span></p>
<p><span class="math inline">\(\| \vec{x} \|\)</span> refers to the <span class="math inline">\(L_2\)</span> or Euclidian norm, namely the length of the vector:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span id="eq-L2"><span class="math display">\[
\| \vec{x} \| =  \sqrt{x^{2}_1 + \ldots + x^{2}_n}
\tag{7}\]</span></span></p>
<p>The result of the dot product is a scalar. The dot product is also commutative: <span class="math inline">\(\vec{u} \cdot \vec{v} = \vec{v} \cdot \vec{u}\)</span>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Watch out when using row or column vectors
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>From the perspective of <em>matrices</em>, if we think of <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> as <strong>column vectors</strong> with dimensions 3 x 1, then transposing <span class="math inline">\(\vec{u}\)</span> gives us conformable matrices and we find the result of matrix multiplication is the dot product (compare to <a href="#eq-dp1">Equation&nbsp;5</a>):</p>
<p><span id="eq-dp3"><span class="math display">\[
\vec{u} \cdot \vec{v} = \vec{u}^\mathsf{T} \ \vec{v} = \begin{bmatrix} u_x &amp; u_y &amp; u_z\end{bmatrix} \begin{bmatrix} v_x \\ v_y \\ v_z \end{bmatrix} = u_x v_x + u_y v_y + u_z v_z
\tag{8}\]</span></span></p>
<p>Even though this is matrix multiplication, the answer is still a scalar.</p>
<p>Now, rather confusingly, if we think of <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> as <strong>row vectors</strong>, and we transpose <span class="math inline">\(\vec{v}\)</span>,then we get the dot product:</p>
<p><span id="eq-dp5"><span class="math display">\[
\vec{u} \cdot \vec{v} = \vec{u} \ \vec{v}^\mathsf{T} = \begin{bmatrix} u_x &amp; u_y &amp; u_z\end{bmatrix} \begin{bmatrix} v_x \\ v_y \\ v_z \end{bmatrix} = u_x v_x + u_y v_y + u_z v_z
\tag{9}\]</span></span></p>
<p>Equations <a href="#eq-dp3">Equation&nbsp;8</a> and <a href="#eq-dp5">Equation&nbsp;9</a> can be a source of real confusion at first. They give the impression that the dot product can be either <span class="math inline">\(\vec{u}^\mathsf{T} \ \vec{v}\)</span> or <span class="math inline">\(\vec{u} \ \vec{v}^\mathsf{T}\)</span>. <em>However, this is only true in the limited contexts defined above.</em> To summarize:</p>
<ul>
<li>Thinking of the vectors as <em>column vectors</em> with dimensions <span class="math inline">\(n \times 1\)</span> then one can use <span class="math inline">\(\vec{u}^\mathsf{T} \ \vec{v}\)</span></li>
<li>Thinking of the vectors as <em>row vectors</em> with dimensions <span class="math inline">\(1 \times n\)</span> then one can use <span class="math inline">\(\vec{u} \ \vec{v}^\mathsf{T}\)</span></li>
</ul>
<p>Unfortunately I think this distinction is not always clearly made by authors, and is a source of great confusion to linear algebra learners. <strong>Be careful when working with row and column vectors.</strong></p>
</div>
</div>
</div>
</section>
<section id="matrix-multiplication" class="level3">
<h3 class="anchored" data-anchor-id="matrix-multiplication">Matrix Multiplication</h3>
<p>Suppose we wanted to compute <span class="math inline">\(\mathbf{A}\mathbf{B} = \mathbf{C}\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> We use the idea of row and column vectors to accomplish this task. In the process, we discover that matrix multiplication is a series of dot products:</p>
<p><span id="eq-dp4"><span class="math display">\[
\begin{multline}
\mathbf{A}\mathbf{B} = \mathbf{C} =
\begin{bmatrix}
\textcolor{red}{a_{11}} &amp; \textcolor{red}{a_{12}} &amp; \textcolor{red}{a_{13}} \\
a_{21} &amp; a_{22} &amp; a_{23} \\
\end{bmatrix}
\begin{bmatrix}
\textcolor{red}{b_{11}} &amp; b_{12} &amp; b_{13} \\
\textcolor{red}{b_{21}} &amp; b_{22} &amp; b_{23} \\
\textcolor{red}{b_{31}} &amp; b_{32} &amp; b_{33} \\
\end{bmatrix} = \\
\begin{bmatrix}
\textcolor{red}{a_{11}b_{11} + a_{12}b_{21} + a_{13}b_{31}} &amp; a_{11}b_{12} + a_{12}b_{22} + a_{13}b_{32} &amp; a_{11}b_{13} + a_{12}b_{23} + a_{13}b_{33}\\
a_{21}b_{11} + a_{22}b_{21} + a_{23}b_{31} &amp; a_{21}b_{12} + a_{22}b_{22} + a_{23}b_{32} &amp; a_{21}b_{13} + a_{22}b_{23} + a_{23}b_{33}\\
\end{bmatrix}
\end{multline}
\tag{10}\]</span></span></p>
<p>The red color shows how the dot product of the first row of <span class="math inline">\(\mathbf{A}\)</span> and the first column of <span class="math inline">\(\mathbf{B}\)</span> gives the first entry in <span class="math inline">\(\mathbf{C}\)</span>. Every entry in <span class="math inline">\(\mathbf{C}\)</span> results from a dot product. Every entry is a scalar, embedded in a matrix.</p>
</section>
<section id="what-can-we-do-with-the-dot-product" class="level3">
<h3 class="anchored" data-anchor-id="what-can-we-do-with-the-dot-product">What Can We Do With the Dot Product?</h3>
<ul>
<li>Determine the angle between two vectors, as in <a href="#eq-dp2">Equation&nbsp;6</a>.</li>
<li>As such, determine if two vectors intersect at a right angle (at least in 2-3D). More generally, two vectors of any dimension are <em>orthogonal</em> if their dot product is zero.</li>
<li>Matrix multiplication, when applied repeatedly.</li>
<li>Compute the length of a vector, via <span class="math inline">\(\sqrt{v \cdot v}\)</span></li>
<li>Compute the projection of one vector on another, for instance how much of a force is along the <span class="math inline">\(x\)</span>-direction? A verbal interpretation of <span class="math inline">\(\vec{u} \cdot \vec{v}\)</span> is it gives the amount of <span class="math inline">\(\vec{v}\)</span> in the direction of <span class="math inline">\(\vec{u}\)</span>.</li>
</ul>
</section>
</section>
<section id="cross-product" class="level2">
<h2 class="anchored" data-anchor-id="cross-product">Cross Product</h2>
<section id="terminology-and-notation" class="level3">
<h3 class="anchored" data-anchor-id="terminology-and-notation">Terminology and Notation</h3>
<p>The cross product goes by these other names: outer product<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, tensor product, vector product.</p>
</section>
<section id="formulas-1" class="level3">
<h3 class="anchored" data-anchor-id="formulas-1">Formulas</h3>
<p>The cross product of two vectors returns a vector rather than a scalar. Vectors are defined in terms of a <em>basis</em> which is a coordinate system. Earlier, when we defined <span class="math inline">\(\vec{u} = (u_x, u_y, u_z)\)</span> it was intrinsically defined in terms of the standard basis set <span class="math inline">\(\hat{i}, \hat{j}, \hat{k}\)</span> (in some fields this would be called the unit coordinate system). Thus a fuller definition of <span class="math inline">\(\vec{u}\)</span> would be:</p>
<p><span id="eq-cp1"><span class="math display">\[
\vec{u} = u_x\hat{i} + u_y\hat{j} + u_z\hat{k}
\tag{11}\]</span></span></p>
<p>In terms of <em>vectors</em>, the cross product is defined as: <span id="eq-cp2"><span class="math display">\[
\vec{u} \times \vec{v} = (a_{y}b_{z} - a_{z}b_{y})\hat{i} + (a_{z}b_{x} - a_{x}b_{z})\hat{j} + (a_{x}b_{y} -a_{y}b_{x})\hat{k}
\tag{12}\]</span></span></p>
<p>In my opinion, this is not exactly intuitive, but there is a pattern to it: notice that the terms for <span class="math inline">\(\hat{i}\)</span> don’t involve the <span class="math inline">\(x\)</span> component. The details of how this result is computed relies on some properties of the basis set; this <a href="https://en.wikipedia.org/wiki/Cross_product#Coordinate_notation">Wikipedia</a> article has a nice explanation. We need not dwell on it however.</p>
<p>There is also a geometric formula for the cross product:</p>
<p><span id="eq-cp4"><span class="math display">\[
\vec{u} \times \vec{v} = \| \vec{u} \| \| \vec{v} \| sin \theta \hat{n}
\tag{13}\]</span></span></p>
<p>where <span class="math inline">\(\hat{n}\)</span> is the unit vector perpendicular to the plane defined by <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span>. The direction of <span class="math inline">\(\hat{n}\)</span> is defined by the <a href="https://en.wikipedia.org/wiki/Right-hand_rule">right-hand rule</a>. Because of this, the cross product is not commutative, i.e.&nbsp;<span class="math inline">\(\vec{u} \times \vec{v} \ne \vec{v} \times \vec{u}\)</span>. The cross product is however anti-commutative: <span class="math inline">\(\vec{u} \times \vec{v} = - (\vec{v} \times \vec{u})\)</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Cross product using column vectors
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we did for the dot product, we can look at the cross product from the perspective of column vectors. Instead of transposing the first matrix as we did for the dot product, we transpose the second one: <span id="eq-cp3"><span class="math display">\[
\vec{u} \times \vec{v} = \vec{u} \ \vec{v}^\mathsf{T} = \begin{bmatrix} u_x \\ u_y \\ u_z\end{bmatrix} \begin{bmatrix} v_x &amp; v_y &amp; v_z \end{bmatrix} = \begin{bmatrix} u_{x}v_{x} &amp; u_{x}v_{y} &amp; u_{x}v_{z} \\ u_{y}v_{x} &amp; u_{y}v_{y} &amp; u_{y}v_{z} \\ u_{z}v_{x} &amp; u_{z}v_{y} &amp; u_{z}v_{z}\\ \end{bmatrix}
\tag{14}\]</span></span></p>
<p>Interestingly, we are using the dot product to compute the cross product.</p>
<p>The case where we treat <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> as row vectors is left to the reader.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
</div>
</div>
<p>Finally, there is a matrix definition of the cross product as well. Evaluation of the following <a href="https://en.wikipedia.org/wiki/Determinant">determinant</a> gives the cross product:</p>
<p><span class="math display">\[
\vec{u} \times \vec{v} = \begin{vmatrix} \hat{i} &amp; \hat{j} &amp; \hat{k}\\ u_{x} &amp; u_{y} &amp; u_{z} \\ v_{x} &amp; v_{y} &amp; v_{z}\\\end{vmatrix}
\]</span></p>
</section>
<section id="what-can-we-do-with-the-cross-product" class="level3">
<h3 class="anchored" data-anchor-id="what-can-we-do-with-the-cross-product">What Can We Do With the Cross Product?</h3>
<ul>
<li>In 3D, the result of the cross product is perpendicular or normal to the plane defined by the two input vectors.</li>
<li>If however, the two vectors are parallel or anti-parallel, the cross product is zero.</li>
<li>The length of the cross product is the area of the parallelogram defined by the two input vectors: <span class="math inline">\(\| \vec{u} \times \vec{v} \|\)</span></li>
</ul>
</section>
</section>
<section id="r-functions" class="level2">
<h2 class="anchored" data-anchor-id="r-functions">R Functions</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"><code>%*%</code></h3>
<p>The workhorse for matrix multiplication in <code>R</code> is the <code>%*%</code> function. This function will accept any combination of vectors and matrices as inputs, so it is flexible. It is also smart: given a vector and a matrix, the vector will be treated as row or column matrix as needed to ensure conformity, if possible. Let’s look at some examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Some data for examples</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>q <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    1    4    7   10   13
[2,]    2    5    8   11   14
[3,]    3    6    9   12   15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># A vector times a vector</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>p <span class="sc">%*%</span> q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  130</code></pre>
</div>
</div>
<p>Notice that <code>R</code> returns a data type of matrix, but it is a <span class="math inline">\(1 \times 1\)</span> matrix, and thus a scalar value. That means we just computed the dot product, a descision <code>R</code> made internally. We can verify this by noting that <code>q %*% p</code> gives the same answer. Thus, <code>R</code> handled these vectors as column vectors and computed <span class="math inline">\(p^{\intercal}q\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># A vector times a matrix</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>M <span class="sc">%*%</span> p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  135
[2,]  150
[3,]  165</code></pre>
</div>
</div>
<p>As <code>M</code> had dimensions <span class="math inline">\(3 \times 5\)</span>, <code>R</code> treated <code>p</code> as a <span class="math inline">\(5 \times 1\)</span> column vector in order to be conformable. The result is a <span class="math inline">\(3 \times 1\)</span> vector, so this is the cross product.</p>
<p>If we try to compute <code>p %*% M</code> we get an error, because there is nothing <code>R</code> can do to <code>p</code> which will make it conformable to <code>M</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>p <span class="sc">%*%</span> M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in p %*% M: non-conformable arguments</code></pre>
</div>
</div>
<p>What about multiplying matrices?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>M <span class="sc">%*%</span> M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in M %*% M: non-conformable arguments</code></pre>
</div>
</div>
<p>As you can see, when dealing with matrices, <code>%*%</code> will not change a thing, and if your matrices are non-conformable then it’s an error. Of course, if we transpose either instance of <code>M</code> we do have conformable matrices, but the answers are different, and this is neither the dot product or the cross product, just matrix multiplication.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">t</span>(M) <span class="sc">%*%</span> M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]   14   32   50   68   86
[2,]   32   77  122  167  212
[3,]   50  122  194  266  338
[4,]   68  167  266  365  464
[5,]   86  212  338  464  590</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>M <span class="sc">%*%</span> <span class="fu">t</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  335  370  405
[2,]  370  410  450
[3,]  405  450  495</code></pre>
</div>
</div>
<p>What can we take from these examples?</p>
<ul>
<li><code>R</code> will give you the <strong>dot product</strong> if you give it two vectors. Note that this is a design decision, as it could have returned the cross product (see <a href="#eq-cp3">Equation&nbsp;14</a>).</li>
<li><code>R</code> will promote a vector to a row or column vector if it can to make it conformable with a matrix you provide. If it cannot, <code>R</code> will give you an error. If it can, the <strong>cross product</strong> is returned.</li>
<li>When it comes to two matrices, <code>R</code> will give an error when they are not conformable.</li>
<li>One function, <code>%*%</code>, does it all: dot product, cross product, or matrix multiplication, but you need to pay attention.</li>
<li>The documentation says as much, but more tersely: “Multiplies two matrices, if they are conformable. If one argument is a vector, it will be promoted to either a row or column matrix to make the two arguments conformable. If both are vectors of the same length, it will return the inner product (as a matrix)”</li>
</ul>
</section>
<section id="other-functions" class="level3">
<h3 class="anchored" data-anchor-id="other-functions">Other Functions</h3>
<p>There are other <code>R</code> functions that do some of the same work:</p>
<ul>
<li><code>crossprod</code> equivalent to <code>t(M) %*% M</code> but faster.</li>
<li><code>tcrossprod</code> equivalent to <code>M %*% t(M)</code> but faster.</li>
<li><code>outer</code> or <code>%o%</code></li>
</ul>
<p>The first two functions will accept combinations of vectors and matrices, as does <code>%*%</code>. Let’s try it with two vectors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">crossprod</span>(p, q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  130</code></pre>
</div>
</div>
<p>Huh. <code>crossprod</code> is returning the <em>dot product</em>! So this is the case where “the cross product is not the cross product.” From a clarity perspective, this is not ideal. Let’s try the other function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">tcrossprod</span>(p, q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    6    7    8    9   10
[2,]   12   14   16   18   20
[3,]   18   21   24   27   30
[4,]   24   28   32   36   40
[5,]   30   35   40   45   50</code></pre>
</div>
</div>
<p>There’s the cross product!</p>
<p>What about <code>outer</code>? Remember that another name for the cross product is the outer product. So is <code>outer</code> the same as <code>tcrossprod</code>? In the case of two vectors, it is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">identical</span>(<span class="fu">outer</span>(p, q), <span class="fu">tcrossprod</span>(p, q))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>What about a vector with a matrix?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>tst <span class="ot">&lt;-</span> <span class="fu">outer</span>(p, M)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">dim</span>(tst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 3 5</code></pre>
</div>
</div>
<p>Alright, that clearly is not a cross product. The result is an array with dimensions <span class="math inline">\(5 \times 3 \times 5\)</span>, not a matrix (which would have only two dimensions). <code>outer</code> <em>does</em> correspond to the cross product in the case of two vectors, but anything with higher dimensions gives a different beast. So perhaps using “outer” as a synonym for cross product is not a good idea.</p>
</section>
</section>
<section id="advice" class="level2">
<h2 class="anchored" data-anchor-id="advice">Advice</h2>
<p>Given what we’ve seen above, make your life simple and stick to <code>%*%</code>, and pay close attention to the dimensions of the arguments, especially if row or column vectors are in use. In my experience, thinking about the units and dimensions of whatever it is you are calculating is very helpful. Later, if speed is really important in your work, you can use one of the faster alternatives.</p>


</section>


<script data-goatcounter="https://chemospec.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>An extensive dicussion of notations can be found <a href="https://mathoverflow.net/q/366070">here</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>And curiously, the <span class="math inline">\(L_2\)</span> norm works out to be equal to the square root of the dot product of a vector with itself: <span class="math inline">\(\| v \| = \sqrt{v \cdot v}\)</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>To be multiplied, matrices must be <em>conformable</em>, namely the number of columns of the first matrix must match the number of rows of the second matrix. The reason is so that the dot product terms will match. In the present case we have <span class="math inline">\(\mathbf{A}^{2\times3}\mathbf{B}^{3\times3} = \mathbf{C}^{2\times3}\)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Be careful, it turns out that “outer” may not be a great synonym for cross product, as explained later.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>OK fine, here is the answer when treating <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> as row vectors: <span class="math inline">\(\vec{u} \times \vec{v} = \vec{u}^\mathsf{T} \ \vec{v}\)</span> which expands exactly as the right-hand side of <a href="#eq-cp3">Equation&nbsp;14</a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{hanson2022,
  author = {Bryan Hanson},
  editor = {},
  title = {Notes on {Linear} {Algebra} {Part} 1},
  date = {2022-08-14},
  url = {http://chemospec.org/2022-08-14-Linear-Alg-Notes.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-hanson2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Bryan Hanson. 2022. <span>“Notes on Linear Algebra Part 1.”</span>
August 14, 2022. <a href="http://chemospec.org/2022-08-14-Linear-Alg-Notes.html">http://chemospec.org/2022-08-14-Linear-Alg-Notes.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="bryanhanson/CSR" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookies are used to track visits only</a></div></div>
  </div>
</footer>



</body></html>